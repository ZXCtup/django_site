{% extends "base.html" %}


{% block content %}

    <div class="container mt-4">
        <div class="row">
            <!-- Основная статья -->
            <div class="col-lg-8">
                <article class="rounded p-4 shadow glass">
                    <!-- Заголовок статьи -->
                    <header class="mb-4">
                        <h2 class="fw-bold text-light mb-3">
                            {{ post.title }}
                        </h2>
                        


                        <!-- Теги -->
                        <div class="mb-4 text-light">
                            {% for tag in post.tag.all %}
                                <a href="#" class="badge bg-primary me-1 exo text-decoration-none" role="button">
                                    {{ tag.title }}
                                </a>                        
                            {% endfor %}
                        </div>

                    </header>

                    <!-- Главное изображение -->
                    <div class="mb-4">
                        {% if post.body_picture %}
                            <img src="{{post.body_picture.url}}" class="img-fluid rounded shadow" alt="{{ post.title }}">
                        
                            <figcaption class="text-light small mt-2 text-center">
                                {{ post.title }}
                            </figcaption>
                        {% endif %}
                    </div>

                    <!-- Краткое описание -->
                    <div class="alert alert-info mb-4">
                        <h5><i class="fas fa-info-circle me-2"></i>Краткое описание</h5>
                        <p class="mb-0 exo">
                            {{ post.shot_description }}
                        </p>
                    </div>

                    <!-- Основной текст статьи -->
                    <div class="article-content">
                        <p class="text-light exo">
                            {{ post.full_description }}
                        </p>
                        <!-- Метаинформация -->
                        <div class="row g-3 my-2 text-light bg-dark rounded px-2">
                            <div class="col-md-6 mt-1">
                                <div class="d-flex align-items-center mb-2">
                                    <span class=" exo">Автор:</span>
                                    <span class="ms-2 exo">{{post.author.username}}</span>
                                </div>
                                <div class="d-flex align-items-center mb-2">
                                    <span class=" exo">Дата публикации:</span>
                                    <span class="ms-2 exo">{{ post.published_date }}</span>
                                </div>
                            </div>
                            <div class="col-md-6 mt-1">
                                <div class="d-flex align-items-center mb-2">
                                    <span class=" exo">Просмотры:</span>
                                    <span class="ms-2 exo">{{ post.views }}</span>
                                </div>
                                <div class="d-flex align-items-center mb-1">
                                    <span class="exo">Категория:</span>
                                    <a class="badge bg-primary ms-1 exo text-decoration-none" role="button"
                                     href="{% url "category" post.category.slug %}">
                                        {{ post.category.title }}
                                    </a>
                                </div>
                            </div>
                        </div>
                    


                    </div>

                </article>

                <!-- Комментарии -->
                <section class="mt-5 rounded p-4 shadow glass">
                    <h3 class="text-warning mb-4 exo">Комментарии ({{ comments.count }})</h3>
                    
                    <!-- Форма добавления комментария -->
                    <div class="mb-4">
                        <h5 class="text-light exo">Оставить комментарий:</h5>
                        <form action="" method="POST">
                            {% csrf_token %}
                            <div class="mb-3">
                                {{form.text}}
                            </div>
                            <button type="submit" class="btn btn-warning">
                                <i class="fas fa-paper-plane me-1"></i>Отправить
                            </button>
                        </form>
                    </div>

                    <!-- Список комментариев -->
                    <div class="comments-list">
                        {% for comment in comments %}
                            <div class="comment mb-3 p-3 bg-dark rounded">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <strong class="text-info">{{ comment.author }}</strong>
                                </div>
                                <p class="mb-2 text-light exo">{{ comment.text }}</p>
                                <p class="mb-0 text-secondary exo">{{ comment.date }}</p>
                            </div>
                        {% endfor %}
                    </div>
                </section>
            </div>

            <!-- Боковая панель -->
            <div class="col-lg-4">
                <!-- Похожие статьи -->
                <div class="rounded p-4 shadow mb-4 glass">
                    <h4 class="text-light mb-3">Похожие статьи</h4>
                    
                    {% for item in rel_posts %}
                    <!-- Похожая статья 1 -->
                    <div class="card bg-dark border-secondary mb-3">
                        <div class="row g-0" style="height: 130px; overflow: hidden; font-size:10px">
                            <div class="col-4">
                                <img src="{{ item.anons_picture.url }}" class="img-fluid rounded-start h-100 object-fit-cover" alt="The Witcher 3">
                            </div>
                            <div class="col-6 d-flex align-items-center">
                                <div class="card-body p-2">
                                    <h6 class="card-title mb-1">
                                        <a href="{% url "post" item.slug %}" class="text-light text-decoration-none exo w-100">{{ item }}</a>
                                    </h6>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}

                    <div class="text-center">
                        <a href="all-posts.html" class="btn btn-outline-light btn-sm">
                            Все статьи
                        </a>
                    </div>
                </div>

                <!-- Популярные категории -->
                <div class="rounded p-4 shadow mb-4 glass">
                    <h4 class="text-light mb-3">Популярные категории</h4>
                    <div class="d-grid gap-2">
                        {% for bc in best_cats %}
                            <a href="{% url "category" bc.slug %}" class="btn btn-outline-info btn-sm d-flex justify-content-between align-items-center">
                                <span>{{ bc.title }}</span>
                                <span class="badge bg-info">{{ bc.total }}</span>
                            </a>
                        {% endfor %}
                    </div>
                </div>

                <!-- Последние новости -->
                <div class="glass rounded p-4 shadow mb-4">
                    <h4 class="text-light mb-3">Последние новости</h4>
                    {% for p in last_posts  %}
                    <div class="list-group list-group-flush">
                        <div class="list-group-item bg-dark border-secondary text-light p-2 mb-2 rounded">
                            <div class="d-flex w-100 justify-content-between align-items-start">
                                <h6 class="mb-1 text-truncate">
                                    <a href="{% url "post" p.slug %}" class="text-light text-decoration-none exo">{{p.title}}</a>
                                </h6>
                            </div>
                        </div>
                    {% endfor %}

                       

                    <div class="text-center mt-3">
                        <a href="{%url "home" %}" class="btn btn-outline-light btn-sm">
                            Больше новостей
                        </a>
                    </div>
                </div>



                <!-- Теги облако -->
                 <div class="glass rounded p-4 shadow">
                    <h4 class="text-light mb-3">Популярные теги</h4>
                    <div class="d-flex flex-wrap gap-1">
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#RPG</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Steam</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Cyberpunk</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#PlayStation</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Xbox</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Nintendo</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Обзоры</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Новости</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Трейлеры</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Гайды</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Моды</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Инди</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#ААА</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Мультиплеер</a>
                        <a href="#" class="badge bg-primary exo text-decoration-none" role="button">#Синглплеер</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock content %}
